<div class="container">
  <div class="back-button">
    <button (click)="goBack()" class="btn-back">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M19 12H5M12 19l-7-7 7-7"/>
      </svg>
      Back to Products
    </button>
  </div>

  <div *ngIf="isLoading" class="loading">
    <div class="spinner"></div>
    <p>Loading product details...</p>
  </div>

  <div *ngIf="errorMessage" class="error-message">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <circle cx="12" cy="12" r="10"/>
      <line x1="12" y1="8" x2="12" y2="12"/>
      <line x1="12" y1="16" x2="12.01" y2="16"/>
    </svg>
    <p>{{ errorMessage }}</p>
    <button (click)="goBack()" class="btn-secondary">Return to Products</button>
  </div>

  <div *ngIf="product && !isLoading" class="product-detail">
    <div class="product-images">
      <div class="main-image">
        <img [src]="selectedImage" [alt]="product.name">
      </div>
      <div class="thumbnail-images" *ngIf="product.imageUrls && product.imageUrls.length > 1">
        <img
          *ngFor="let imageUrl of product.imageUrls"
          [src]="getImageUrl(imageUrl)"
          [alt]="product.name"
          [class.active]="selectedImage === getImageUrl(imageUrl)"
          (click)="selectImage(getImageUrl(imageUrl))">
      </div>
    </div>

    <div class="product-info">
      <div class="product-header">
        <h1>{{ product.name }}</h1>
        <span class="product-category">{{ product.category }}</span>
      </div>

      <div class="product-price">
        <span class="price">${{ product.price.toFixed(2) }}</span>
        <span class="stock-status" [class.in-stock]="product.stockQuantity > 0" [class.out-of-stock]="product.stockQuantity === 0">
          {{ product.stockQuantity > 0 ? 'In Stock (' + product.stockQuantity + ' available)' : 'Out of Stock' }}
        </span>
      </div>

      <div class="product-description">
        <h3>Description</h3>
        <p>{{ product.description }}</p>
      </div>

      <div class="product-details">
        <div class="detail-item">
          <span class="label">SKU:</span>
          <span class="value">{{ product.skuCode }}</span>
        </div>
        <div class="detail-item">
          <span class="label">Category:</span>
          <span class="value">{{ product.category }}</span>
        </div>
        <div class="detail-item">
          <span class="label">Status:</span>
          <span class="value">{{ product.active ? 'Active' : 'Inactive' }}</span>
        </div>
      </div>

      <div class="product-actions" *ngIf="product.stockQuantity > 0">
        <div class="quantity-selector">
          <label>Quantity:</label>
          <div class="quantity-controls">
            <button (click)="decreaseQuantity()" [disabled]="quantity <= 1" class="btn-quantity">-</button>
            <input type="number" [(ngModel)]="quantity" [min]="1" [max]="product.stockQuantity" readonly>
            <button (click)="increaseQuantity()" [disabled]="quantity >= product.stockQuantity" class="btn-quantity">+</button>
          </div>
        </div>

        <div class="action-buttons">
          <button (click)="addToCart()" class="btn-add-to-cart" [disabled]="isInCart()">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="9" cy="21" r="1"/>
              <circle cx="20" cy="21" r="1"/>
              <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a 2 0 0 0 2-1.61L23 6H6"/>
            </svg>
            {{ isInCart() ? 'Already in Cart' : 'Add to Cart' }}
          </button>
          <button (click)="buyNow()" class="btn-buy-now">
            Buy Now
          </button>
        </div>
      </div>

      <div class="out-of-stock-message" *ngIf="product.stockQuantity === 0">
        <p>This product is currently out of stock. Please check back later.</p>
      </div>
    </div>
  </div>


</div>
