<div class="user-detail-container">
  <!-- Header -->
  <div class="page-header">
    <button class="btn-back" (click)="goBack()">
      <i class="fas fa-arrow-left"></i>
    </button>
    <div class="header-content">
      <h1>User Details</h1>
      <div class="header-actions">
        <button class="btn btn-secondary" (click)="toggleStatus()" *ngIf="user">
          <i [class]="user.enabled ? 'fas fa-ban' : 'fas fa-check-circle'"></i>
          {{ user.enabled ? 'Disable User' : 'Enable User' }}
        </button>
        <button class="btn btn-primary" (click)="editUser()">
          <i class="fas fa-edit"></i>
          Edit User
        </button>
        <button class="btn btn-danger" (click)="deleteUser()">
          <i class="fas fa-trash"></i>
          Delete
        </button>
      </div>
    </div>
  </div>

  <!-- Loading -->
  <div *ngIf="loading" class="loading-container">
    <div class="spinner"></div>
    <p>Loading user details...</p>
  </div>

  <!-- Error -->
  <div *ngIf="error && !loading" class="error-message">
    <i class="fas fa-exclamation-circle"></i>
    {{ error }}
  </div>

  <!-- User Details -->
  <div *ngIf="user && !loading" class="user-content">
    <!-- User Profile Card -->
    <div class="profile-card">
      <div class="profile-header">
        <div class="user-avatar-large">{{ getInitials() }}</div>
        <div class="profile-info">
          <h2>{{ user.firstName }} {{ user.lastName }}</h2>
          <p class="username">{{ '@' + user.username }}</p>
          <div class="profile-badges">
            <span class="role-badge" [ngClass]="getRoleBadgeClass(user.roles)">
              {{ getRoleDisplay(user.roles) }}
            </span>
            <span class="status-badge" [ngClass]="user.enabled ? 'badge-active' : 'badge-inactive'">
              {{ user.enabled ? 'Active' : 'Inactive' }}
            </span>
            <span class="verified-badge" *ngIf="user.emailVerified">
              <i class="fas fa-check-circle"></i>
              Verified
            </span>
          </div>
        </div>
      </div>
    </div>

    <!-- Contact Information -->
    <div class="info-section">
      <h3><i class="fas fa-address-card"></i> Contact Information</h3>
      <div class="info-grid">
        <div class="info-item">
          <label>Email</label>
          <div class="info-value">
            <i class="fas fa-envelope"></i>
            {{ user.email }}
          </div>
        </div>
        <div class="info-item">
          <label>Phone</label>
          <div class="info-value">
            <i class="fas fa-phone"></i>
            {{ user.phone || 'Not provided' }}
          </div>
        </div>
        <div class="info-item full-width">
          <label>Address</label>
          <div class="info-value">
            <i class="fas fa-map-marker-alt"></i>
            {{ user.address || 'Not provided' }}
          </div>
        </div>
      </div>
    </div>

    <!-- Account Information -->
    <div class="info-section">
      <h3><i class="fas fa-info-circle"></i> Account Information</h3>
      <div class="info-grid">
        <div class="info-item">
          <label>User ID</label>
          <div class="info-value">
            <i class="fas fa-id-card"></i>
            {{ user.id }}
          </div>
        </div>
        <div class="info-item">
          <label>Keycloak ID</label>
          <div class="info-value">
            <i class="fas fa-key"></i>
            {{ user.keycloak_id }}
          </div>
        </div>
        <div class="info-item">
          <label>Account Created</label>
          <div class="info-value">
            <i class="fas fa-calendar-plus"></i>
            {{ formatDate(user.createdAt) }}
          </div>
        </div>
        <div class="info-item">
          <label>Last Updated</label>
          <div class="info-value">
            <i class="fas fa-clock"></i>
            {{ formatDate(user.updatedAt) }}
          </div>
        </div>
        <div class="info-item" *ngIf="user.lastLogin">
          <label>Last Login</label>
          <div class="info-value">
            <i class="fas fa-sign-in-alt"></i>
            {{ formatDate(user.lastLogin) }}
          </div>
        </div>
      </div>
    </div>

    <!-- Roles & Permissions -->
    <div class="info-section">
      <h3><i class="fas fa-user-tag"></i> Roles & Permissions</h3>
      <div class="roles-list">
        <div *ngFor="let role of user.roles" class="role-item" [ngClass]="getRoleBadgeClass([role])">
          <i class="fas" [ngClass]="{
            'fa-user-shield': role === 'admin',
            'fa-store': role === 'seller',
            'fa-shopping-cart': role === 'customer'
          }"></i>
          {{ role.charAt(0).toUpperCase() + role.slice(1) }}
        </div>
      </div>
    </div>
  </div>
</div>
